        -:    0:Source:print_tokens_instrumented.c
        -:    0:Graph:print_tokens_instrumented.gcno
        -:    0:Data:print_tokens_instrumented.gcda
        -:    0:Runs:4130
        -:    1:
        -:    2:
        -:    3:# include <ctype.h>
        -:    4:#include <signal.h>
        -:    5:
        -:    6:# define START  5
        -:    7:# define TRUE  1
        -:    8:# define FALSE 0
        -:    9:
        -:   10:typedef int BOOLEAN;
        -:   11:typedef char *string;
        -:   12:
        -:   13:# include <stdio.h>
        -:   14:# include "tokens.h"
        -:   15:
        -:   16:static token numeric_case();
        -:   17:static token error_or_eof_case();
        -:   18:static int check_delimiter();
        -:   19:static int keyword(int state);
        -:   20:static int special(int state);
        -:   21:static skip(character_stream stream_ptr);
        -:   22:static int constant(int state,char token_str[],int token_ind);
        -:   23:static int next_state();
        -:   24:static get_actual_token(char token_str[],int token_ind);
        -:   25:
        -:   26:FILE* file_name = NULL;
        -:   27:
        -:   28:// Signal handler for SIGSEGV 
        -:   29:// add by mshadow
    #####:   30:void segfault_handler(int sig) {
    #####:   31:    exit(sig);  // Exit the program
        -:   32:}
        -:   33:
     4130:   34:main(argc,argv)
        -:   35:int argc;
        -:   36:char *argv[];
        -:   37:{   
     4130:   38:    signal(SIGSEGV, segfault_handler);
     4130:   39:    file_name=fopen("v6.txt","a+"); 
     4130:   40:    if(!file_name)
        -:   41:    {	
    #####:   42:        printf("File could not be opened! \n");
    #####:   43:        fclose(file_name);
    #####:   44:        exit(0);
        -:   45:    }
        -:   46:	
        -:   47:    token token_ptr;
        -:   48:    token_stream stream_ptr;
     4130:   49:    fprintf(file_name,"\nP1,");
     4130:   50:    if(argc>2)
        -:   51:    {
       30:   52:        fprintf(file_name,"P2,");
       30:   53:        fprintf(stdout, "The format is print_tokens filename(optional)\n");
       30:   54:        fclose(file_name);
       30:   55:        exit(1);
        -:   56:    }
        -:   57:    
     4100:   58:    stream_ptr=open_token_stream(argv[1]);
     4070:   59:    fprintf(file_name,"P3,");
    34603:   60:    while(!is_eof_token((token_ptr=get_token(stream_ptr))))
        -:   61:    {
    30533:   62:        fprintf(file_name,"P4,");
    30533:   63:        print_token(token_ptr);
        -:   64:    }
        -:   65:            
     4070:   66:    fprintf(file_name,"P5,");
     4070:   67:    print_token(token_ptr);
     4070:   68:    fclose(file_name);
     4070:   69:    exit(0);
        -:   70:}
        -:   71:
     4100:   72:character_stream open_character_stream(FILENAME)
        -:   73:string FILENAME;
        -:   74:{
        -:   75:    character_stream stream_ptr;
     4100:   76:    stream_ptr=(character_stream)malloc(sizeof(struct stream_type));
     4100:   77:    stream_ptr->stream_ind=START;
     4100:   78:    stream_ptr->stream[START]='\0';
     4100:   79:    fprintf(file_name,"P6,");
     4100:   80:    if(FILENAME == NULL)
        -:   81:    {
     2963:   82:        fprintf(file_name,"P7,");
     2963:   83:        stream_ptr->fp=stdin;
        -:   84:    }
     1137:   85:    else if((stream_ptr->fp=fopen(FILENAME,"r"))==NULL)
        -:   86:    {
       30:   87:        fprintf(file_name,"P8,");
       30:   88:        fprintf(stdout, "The file %s doesn't exists\n",FILENAME);
       30:   89:        fclose(file_name);
       30:   90:        exit(0);
        -:   91:    }
     4070:   92:    fprintf(file_name,"P9,");
     4070:   93:    return(stream_ptr);
        -:   94:}
        -:   95:
   176003:   96:CHARACTER get_char(stream_ptr)
        -:   97:character_stream stream_ptr;
        -:   98:{
   176003:   99:    fprintf(file_name,"P10,");
   176003:  100:    if(stream_ptr->stream[stream_ptr->stream_ind] == '\0')
        -:  101:    {
    12791:  102:        fprintf(file_name,"P11,");
    12791:  103:        if(fgets(stream_ptr->stream+START,80-START,stream_ptr->fp) == NULL)/* Fix bug: add -START - hf*/
        -:  104:        {
     4070:  105:            fprintf(file_name,"P12,");
     4070:  106:            stream_ptr->stream[START]=EOF;
        -:  107:        }
    12791:  108:        fprintf(file_name,"P13,");
    12791:  109:        stream_ptr->stream_ind=START;
        -:  110:    }
   176003:  111:    fprintf(file_name,"P14,");
   176003:  112:    return(stream_ptr->stream[(stream_ptr->stream_ind)++]);
        -:  113:}
        -:  114:
    30136:  115:BOOLEAN is_end_of_character_stream(stream_ptr)
        -:  116:character_stream stream_ptr;
        -:  117:{
    30136:  118:    fprintf(file_name,"P15,");
    30136:  119:    if(stream_ptr->stream[stream_ptr->stream_ind-1] == EOF)
        -:  120:	{
     4112:  121:        fprintf(file_name,"P16,");
     4112:  122:        return(TRUE);
        -:  123:    } 
        -:  124:    else
        -:  125:    {
    26024:  126:        fprintf(file_name,"P17,");
    26024:  127:        return(FALSE);
        -:  128:    }
        -:  129:        
        -:  130:}
        -:  131:
    15031:  132:unget_char(ch,stream_ptr)
        -:  133:CHARACTER ch;
        -:  134:character_stream stream_ptr;
        -:  135:{
    15031:  136:    fprintf(file_name,"P18,");
    15031:  137:    if(stream_ptr->stream_ind == 0)
        -:  138:	{
    #####:  139:        fprintf(file_name,"P19,");
    #####:  140:        return;
        -:  141:    }
        -:  142:    else
        -:  143:	{
    15031:  144:        fprintf(file_name,"P20,");
    15031:  145:        stream_ptr->stream[--(stream_ptr->stream_ind)]=ch;
        -:  146:    }
    15031:  147:    fprintf(file_name,"P21,");  
    15031:  148:    return;
        -:  149:}
        -:  150:
     4100:  151:token_stream open_token_stream(FILENAME)
        -:  152:string FILENAME;
        -:  153:{
     4100:  154:    fprintf(file_name,"P22,");  
        -:  155:    token_stream token_ptr;
     4100:  156:    token_ptr=(token_stream)malloc(sizeof(struct token_stream_type));
     4100:  157:    token_ptr->ch_stream=open_character_stream(FILENAME);
     4070:  158:    return(token_ptr);
        -:  159:}
        -:  160:
    34603:  161:token get_token(tstream_ptr)
        -:  162:token_stream tstream_ptr;
        -:  163:{
        -:  164:    char token_str[80]; /* This buffer stores the current token */
        -:  165:    int token_ind;      /* Index to the token_str  */
        -:  166:    token token_ptr;
        -:  167:    CHARACTER ch;
        -:  168:    int cu_state,next_st,token_found;
    34603:  169:    token_ptr=(token)(malloc(sizeof(struct token_type)));
    34603:  170:    ch=get_char(tstream_ptr->ch_stream);
    34603:  171:    cu_state=token_ind=token_found=0;
    34603:  172:    fprintf(file_name,"P23,");  
   151954:  173:    while(!token_found)
        -:  174:    {
   151954:  175:        fprintf(file_name,"P24,");
   151954:  176:        if(token_ind < 80) /* ADDED ERROR CHECK - hf */
        -:  177:        {
   151917:  178:            fprintf(file_name,"P25,");
   151917:  179:            token_str[token_ind++]=ch;
   151917:  180:            next_st=next_state(cu_state,ch);
        -:  181:        }
        -:  182:        else
        -:  183:        {
       37:  184:            fprintf(file_name,"P26,");
       37:  185:            next_st = -1; /* - hf */
        -:  186:        }
   151954:  187:        if (next_st == -1) 
        -:  188:        {
    12173:  189:            fprintf(file_name,"P27,");
    34603:  190:            return(error_or_eof_case(tstream_ptr, token_ptr,cu_state,token_str,token_ind,ch));
        -:  191:        } 
   139781:  192:        else if (next_st == -2) 
        -:  193:        {
     2621:  194:            fprintf(file_name,"P28,");
     2621:  195:            return(numeric_case(tstream_ptr,token_ptr,ch, token_str,token_ind));
        -:  196:        } 
   137160:  197:        else if (next_st == -3) 
        -:  198:        {
     8942:  199:            fprintf(file_name,"P29,");
     8942:  200:            token_ptr->token_id=IDENTIFIER;
     8942:  201:            unget_char(ch,tstream_ptr->ch_stream);
     8942:  202:            token_ind--;
     8942:  203:            get_actual_token(token_str,token_ind);
     8942:  204:            strcpy(token_ptr->token_string,token_str);
     8942:  205:            return(token_ptr);
        -:  206:        } 
        -:  207:
   128218:  208:        fprintf(file_name,"P30,");  
   128218:  209:        switch(next_st) 
        -:  210:        { 
   115404:  211:            default : 
   115404:  212:                fprintf(file_name,"P31,"); 
   115404:  213:                break;
     2210:  214:            case 6  : /* These are all KEYWORD cases. */
        -:  215:            case 9  :
        -:  216:            case 11 :
        -:  217:            case 13 :
        -:  218:            
        -:  219:			case 16 :
     2210:  220:                ch=get_char(tstream_ptr->ch_stream);
     2210:  221:                fprintf(file_name,"P32,");
     2210:  222:                if(check_delimiter(ch)==TRUE)
        -:  223:                {
     2166:  224:                    fprintf(file_name,"P33,");
     2166:  225:                    token_ptr->token_id=keyword(next_st);
     2166:  226:                    unget_char(ch,tstream_ptr->ch_stream);
     2166:  227:                    token_ptr->token_string[0]='\0';
     2166:  228:                    return(token_ptr);
        -:  229:                }
       44:  230:                fprintf(file_name,"P34,");
       44:  231:                unget_char(ch,tstream_ptr->ch_stream);
       44:  232:                break;
     5217:  233:            case 19 : /* These are all special SPECIAL character */
        -:  234:            case 20 : /* cases */
        -:  235:            case 21 :
        -:  236:            case 22 :
        -:  237:            case 23 :
        -:  238:            case 24 :
        -:  239:            case 25 :
        -:  240:            case 32 : 
     5217:  241:                fprintf(file_name,"P35,");
     5217:  242:                token_ptr->token_id=special(next_st);
     5217:  243:                token_ptr->token_string[0]='\0';
     5217:  244:                return(token_ptr);
     3484:  245:            case 27 : /* These are constant cases */
        -:  246:            case 29 :
     3484:  247:                fprintf(file_name,"P36,");
     3484:  248:                token_ptr->token_id=constant(next_st,token_str,token_ind);
     3484:  249:                get_actual_token(token_str,token_ind);
     3484:  250:                strcpy(token_ptr->token_string,token_str);
     3484:  251:                return(token_ptr);
     1903:  252:            case 30 :  /* This is COMMENT case */
     1903:  253:                fprintf(file_name,"P37,");
     1903:  254:                skip(tstream_ptr->ch_stream);
     1903:  255:                token_ind=next_st=0;
     1903:  256:                break;
        -:  257:        }
   117351:  258:        fprintf(file_name,"P38,");
   117351:  259:        cu_state=next_st;
   117351:  260:        ch=get_char(tstream_ptr->ch_stream);
        -:  261:    }
    #####:  262:}
        -:  263:
     2621:  264:static token numeric_case(tstream_ptr,token_ptr,ch,token_str,token_ind)
        -:  265:token_stream tstream_ptr;
        -:  266:token token_ptr;
        -:  267:char ch,token_str[];
        -:  268:int token_ind;
        -:  269:{
     2621:  270:    fprintf(file_name,"P39,");
     2621:  271:    if(check_delimiter(ch)!=TRUE)
        -:  272:    {   /* Error case */
      674:  273:        token_ptr->token_id=ERROR;
      674:  274:        fprintf(file_name,"P40,");
     2689:  275:        while(check_delimiter(ch)==FALSE)
        -:  276:        {
     2015:  277:            fprintf(file_name,"P41,");
     2015:  278:            if(token_ind >= 80)
        -:  279:            {
    #####:  280:                fprintf(file_name,"P42,");
    #####:  281:                break;
        -:  282:            }
     2015:  283:            fprintf(file_name,"P43,");  
     2015:  284:            token_str[token_ind++]=ch=get_char(tstream_ptr->ch_stream);
        -:  285:        }
      674:  286:        fprintf(file_name,"P44,");
      674:  287:        unget_char(ch,tstream_ptr->ch_stream);
      674:  288:        token_ind--;
      674:  289:        get_actual_token(token_str,token_ind);
      674:  290:        strcpy(token_ptr->token_string,token_str);
      674:  291:        return(token_ptr);
        -:  292:    }
     1947:  293:    fprintf(file_name,"P45,");
     1947:  294:    token_ptr->token_id=NUMERIC; /* Numeric case */
     1947:  295:    unget_char(ch,tstream_ptr->ch_stream);
     1947:  296:    token_ind--;
     1947:  297:    get_actual_token(token_str,token_ind);
     1947:  298:    strcpy(token_ptr->token_string,token_str);
     1947:  299:    return(token_ptr);
        -:  300:}
        -:  301:
    12173:  302:static token error_or_eof_case(tstream_ptr,token_ptr,cu_state,token_str,token_ind,ch)
        -:  303:token_stream tstream_ptr;
        -:  304:token token_ptr;
        -:  305:int cu_state,token_ind;
        -:  306:char token_str[],ch;
        -:  307:{
    12173:  308:    fprintf(file_name,"P46,");
    12173:  309:    if(is_end_of_character_stream(tstream_ptr->ch_stream)) 
        -:  310:    {
     4070:  311:        fprintf(file_name,"P47,");
     4070:  312:        token_ptr->token_id = EOTSTREAM;
     4070:  313:        token_ptr->token_string[0]='\0';
     4070:  314:        return(token_ptr);
        -:  315:    }
     8103:  316:    fprintf(file_name,"P48,");
     8103:  317:    if(cu_state !=0)
        -:  318:    {
     1216:  319:        fprintf(file_name,"P49,");
     1216:  320:        unget_char(ch,tstream_ptr->ch_stream);
     1216:  321:        token_ind--;
        -:  322:    }
     8103:  323:    fprintf(file_name,"P50,");
     8103:  324:    token_ptr->token_id=ERROR;
     8103:  325:    get_actual_token(token_str,token_ind);
     8103:  326:    strcpy(token_ptr->token_string,token_str);
     8103:  327:    return(token_ptr);                
        -:  328:}
        -:  329:
     7520:  330:static int check_delimiter(ch)
        -:  331:char ch;
        -:  332:{
     7520:  333:    fprintf(file_name,"P51,");
     7520:  334:    if(!isalpha(ch) && !isdigit(ch))
        -:  335:    {
     4787:  336:        fprintf(file_name,"P52,");
     4787:  337:        return(TRUE);
        -:  338:    }
     2733:  339:    fprintf(file_name,"P53,");
     2733:  340:    return(FALSE);
        -:  341:}
        -:  342:
     2166:  343:static int keyword(state)
        -:  344:int state;
        -:  345:{
     2166:  346:    fprintf(file_name,"P54,"); 
     2166:  347:    switch(state)
        -:  348:    {   /* Return the respective macro for the Keyword. */
      449:  349:        case 6 : 
      449:  350:            fprintf(file_name,"P55,"); 
      449:  351:            return(LAMBDA);
      445:  352:        case 9 : 
      445:  353:            fprintf(file_name,"P56,"); 
      445:  354:            return(AND);
      427:  355:        case 11:   
      427:  356:            fprintf(file_name,"P57,"); 
      427:  357:            return(OR);
      402:  358:        case 13: 
      402:  359:            fprintf(file_name,"P58,"); 
      402:  360:            return(IF);
      443:  361:        case 16:   
      443:  362:            fprintf(file_name,"P59,"); 
      443:  363:            return(XOR);
    #####:  364:        default: 
    #####:  365:            fprintf(file_name,"P60,"); 
    #####:  366:            fprintf(stdout, "error\n");break;
        -:  367:    }
    #####:  368:    fprintf(file_name,"P61,");
    #####:  369:    fclose(file_name);
    #####:  370:    exit(0);
        -:  371:}
        -:  372:
     5217:  373:static int special(state)
        -:  374:int state;
        -:  375:{
     5217:  376:    fprintf(file_name,"P62,"); 
     5217:  377:    switch(state)
        -:  378:    {   /* return the respective macro for the special character. */
      629:  379:        case 19: 
      629:  380:            fprintf(file_name,"P63,"); 
      629:  381:            return(LPAREN);
      685:  382:        case 20: 
      685:  383:            fprintf(file_name,"P64,"); 
      685:  384:            return(RPAREN);
      693:  385:        case 21: 
      693:  386:            fprintf(file_name,"P65,"); 
      693:  387:            return(LSQUARE);
      694:  388:        case 22: 
      694:  389:            fprintf(file_name,"P66,"); 
      694:  390:            return(RSQUARE);
      674:  391:        case 23: 
      674:  392:            fprintf(file_name,"P67,"); 
      674:  393:            return(QUOTE);
      685:  394:        case 24: 
      685:  395:            fprintf(file_name,"P68,"); 
      685:  396:            return(BQUOTE);
      654:  397:        case 25: 
      654:  398:            fprintf(file_name,"P69,"); 
      654:  399:            return(COMMA);
      503:  400:        case 32: 
      503:  401:            fprintf(file_name,"P70,"); 
      503:  402:            return(EQUALGREATER);
    #####:  403:        default: 
    #####:  404:            fprintf(file_name,"P71,");
    #####:  405:            fprintf(stdout, "error\n");break;
        -:  406:    }
    #####:  407:    fprintf(file_name,"P72,");
    #####:  408:    fclose(file_name);
    #####:  409:    exit(0);
        -:  410:}
        -:  411:
     1903:  412:static skip(stream_ptr)
        -:  413:character_stream stream_ptr;
        -:  414:{
        -:  415:    char c;
     1903:  416:    fprintf(file_name,"P73,"); 
    19824:  417:    while((c=get_char(stream_ptr))!='\n' && !is_end_of_character_stream(stream_ptr));
        -:  418:
     1903:  419:    fprintf(file_name,"P74,"); 
     1903:  420:	if(c==EOF)
        -:  421:    {
       42:  422:        fprintf(file_name,"P75,");
       42:  423:        unget_char(c, stream_ptr); /* Put back to leave gracefully - hf */
        -:  424:    }
     1903:  425:    fprintf(file_name,"P76,");
     1903:  426:    return;
        -:  427:}
        -:  428:
     3484:  429:static int constant(state,token_str,token_ind)
        -:  430:int state,token_ind;
        -:  431:char token_str[];
        -:  432:{
     3484:  433:    fprintf(file_name,"P77,"); 
     3484:  434:    switch(state)
        -:  435:    {   /* Return the respective CONSTANT macro. */
     1564:  436:        case 27 : 
     1564:  437:            fprintf(file_name,"P78,"); 
     1564:  438:            return(STRING_CONSTANT);
     1920:  439:        case 29 : 
     1920:  440:            fprintf(file_name,"P79,"); 
     1920:  441:            token_str[token_ind-2]=' '; 
     1920:  442:            return(CHARACTER_CONSTANT);
    #####:  443:        default : 
    #####:  444:            fprintf(file_name,"P80,");
    #####:  445:            break;
        -:  446:    }
    #####:  447:}
        -:  448:              
   240356:  449:static int next_state(state,ch)
        -:  450:int state;
        -:  451:char ch;
        -:  452:{
   240356:  453:    fprintf(file_name,"P81,"); 
   240356:  454:    if(state < 0)
        -:  455:    {
    23699:  456:        fprintf(file_name,"P82,");
    23699:  457:        return(state);
        -:  458:    }
        -:  459:    
   216657:  460:    fprintf(file_name,"P83,"); 
   216657:  461:    if(base[state]+ch >= 0)
        -:  462:    {
   205832:  463:        fprintf(file_name,"P84,"); 
   205832:  464:        if(check[base[state]+ch] == state) /* Check for the right state */
        -:  465:        {
   128218:  466:            fprintf(file_name,"P85,");
   128218:  467:            return(next[base[state]+ch]);
        -:  468:        }   
        -:  469:        else
        -:  470:        {
    77614:  471:            fprintf(file_name,"P86,");
    77614:  472:            return(next_state(default1[state],ch));
        -:  473:        }
        -:  474:    }
        -:  475:    else
        -:  476:    {
    10825:  477:        fprintf(file_name,"P87,");
    10825:  478:        return(next_state(default1[state],ch));
        -:  479:    }
        -:  480:}
        -:  481:
    34603:  482:BOOLEAN is_eof_token(t)
        -:  483:token t;
        -:  484:{
    34603:  485:    fprintf(file_name,"P88,"); 
    34603:  486:    if(t->token_id==EOTSTREAM)
        -:  487:    {
     4070:  488:        fprintf(file_name,"P89,");
     4070:  489:        return(TRUE);
        -:  490:    }
    30533:  491:    fprintf(file_name,"P90,");    
    30533:  492:    return(FALSE);
        -:  493:}
        -:  494:
    34603:  495:BOOLEAN print_token(token_ptr)
        -:  496:token token_ptr;
        -:  497:{
    34603:  498:    fprintf(file_name,"P91,"); 
    34603:  499:    switch(token_ptr->token_id)
        -:  500:    {    /* Print the respective tokens. */
     8777:  501:        case ERROR : 
     8777:  502:            fprintf(file_name,"P92,"); 
     8777:  503:            fprintf(stdout, "error,\t\"");
     8777:  504:            fprintf(stdout, "%s",token_ptr->token_string);
     8777:  505:            fprintf(stdout, "\".\n");
     8777:  506:            return(TRUE);
        -:  507:
     4070:  508:        case EOTSTREAM : 
     4070:  509:            fprintf(file_name,"P93,"); 
     4070:  510:            fprintf(stdout, "eof.\n");
     4070:  511:            return(TRUE);
        -:  512:
      449:  513:        case 6 : 
      449:  514:            fprintf(file_name,"P94,"); 
      449:  515:            fprintf(stdout, "keyword,\t\"lambda\".\n");
      449:  516:            return(TRUE);
        -:  517:
      445:  518:        case 9 : 
      445:  519:            fprintf(file_name,"P95,"); 
      445:  520:            fprintf(stdout, "keyword,\t\"and\".\n");
      445:  521:            return(TRUE);
        -:  522:
      427:  523:        case 11: 
      427:  524:            fprintf(file_name,"P96,"); 
      427:  525:            fprintf(stdout, "keyword,\t\"or\".\n");
      427:  526:            return(TRUE);
        -:  527:
      402:  528:        case 13: 
      402:  529:            fprintf(file_name,"P97,"); 
      402:  530:            fprintf(stdout, "keyword,\t\"if\".\n");
      402:  531:            return(TRUE);
        -:  532:
      443:  533:        case 16: 
      443:  534:            fprintf(file_name,"P98,"); 
      443:  535:            fprintf(stdout, "keyword,\t\"xor\".\n");
      443:  536:            return(TRUE);
        -:  537:
     8942:  538:        case 17: 
     8942:  539:            fprintf(file_name,"P99,"); 
     8942:  540:            fprintf(stdout, "identifier,\t\"");
     8942:  541:            fprintf(stdout, "%s",token_ptr->token_string);
     8942:  542:            fprintf(stdout, "\".\n");
     8942:  543:            return(TRUE);
        -:  544:
     1947:  545:        case 18: 
     1947:  546:            fprintf(file_name,"P100,"); 
     1947:  547:            fprintf(stdout, "numeric,\t");
     1947:  548:            fprintf(stdout, "%s",token_ptr->token_string);
     1947:  549:            fprintf(stdout, ".\n");
     1947:  550:            return(TRUE);
        -:  551:
      629:  552:        case 19: 
      629:  553:            fprintf(file_name,"P101,"); 
      629:  554:            fprintf(stdout, "lparen.\n");
      629:  555:            return(TRUE);
        -:  556:
      685:  557:        case 20: 
      685:  558:            fprintf(file_name,"P102,"); 
      685:  559:            fprintf(stdout, "rparen.\n");
      685:  560:            return(TRUE);
        -:  561:
      693:  562:        case 21: 
      693:  563:            fprintf(file_name,"P103,"); 
      693:  564:            fprintf(stdout, "lsquare.\n");
      693:  565:            return(TRUE);
        -:  566:
      694:  567:        case 22: 
      694:  568:            fprintf(file_name,"P104,"); 
      694:  569:            fprintf(stdout, "rsquare.\n");
      694:  570:            return(TRUE);
        -:  571:
      674:  572:        case 23: 
      674:  573:            fprintf(file_name,"P105,"); 
      674:  574:            fprintf(stdout, "quote.\n");
      674:  575:            return(TRUE);
        -:  576:
      685:  577:        case 24: 
      685:  578:            fprintf(file_name,"P106,"); 
      685:  579:            fprintf(stdout, "bquote.\n");
      685:  580:            return(TRUE);
        -:  581:
      654:  582:        case 25: 
      654:  583:            fprintf(file_name,"P107,"); 
      654:  584:            fprintf(stdout, "comma.\n");
      654:  585:            return(TRUE);
        -:  586:
     1564:  587:        case 27: 
     1564:  588:            fprintf(file_name,"P108,"); 
     1564:  589:            fprintf(stdout, "string,\t");
     1564:  590:            fprintf(stdout, "%s",token_ptr->token_string);
     1564:  591:            fprintf(stdout, ".\n");
     1564:  592:            return(TRUE);
        -:  593:
     1920:  594:        case 29: 
     1920:  595:            fprintf(file_name,"P109,"); 
     1920:  596:            fprintf(stdout, "character,\t\"");
     1920:  597:            fprintf(stdout, "%s",token_ptr->token_string);
     1920:  598:            fprintf(stdout, "\".\n");
     1920:  599:            return(TRUE);
        -:  600:
      503:  601:        case 32: 
      503:  602:            fprintf(file_name,"P110,"); 
      503:  603:            fprintf(stdout, "keyword,\t\"=>\".\n");
      503:  604:            return(TRUE);
        -:  605:
    #####:  606:        default: 
    #####:  607:            fprintf(file_name,"P111,");
    #####:  608:            break;
        -:  609:    }
    #####:  610:    fprintf(file_name,"P112,");
    #####:  611:    return(FALSE);
        -:  612:}
        -:  613:
    23150:  614:static get_actual_token(token_str,token_ind)
        -:  615:int token_ind;
        -:  616:char token_str[];
        -:  617:{
        -:  618:    int ind,start;
    23150:  619:    fprintf(file_name,"P113,");
    25690:  620:    for(ind=token_ind;ind>0 && isspace(token_str[ind-1]);--ind);
    23150:  621:    fprintf(file_name,"P114,");
    23150:  622:    token_str[ind]='\0';token_ind=ind;
    23150:  623:    fprintf(file_name,"P115,");
    37936:  624:    for(ind=0;ind<token_ind;++ind)
        -:  625:    {
    37882:  626:        fprintf(file_name,"P116,");
    37882:  627:        if(!isspace(token_str[ind]))
        -:  628:        {
    23096:  629:            fprintf(file_name,"P117,");
    23096:  630:            break;
        -:  631:        }
        -:  632:    }
        -:  633:        
    23150:  634:    fprintf(file_name,"P118,");   
   126033:  635:    for(start=0;ind<=token_ind;++start,++ind)
        -:  636:    {
   102883:  637:        fprintf(file_name,"P119,");
   102883:  638:        token_str[start]=token_str[ind];
        -:  639:    }
    23150:  640:    fprintf(file_name,"P120,");
    23150:  641:    return;
        -:  642:}
